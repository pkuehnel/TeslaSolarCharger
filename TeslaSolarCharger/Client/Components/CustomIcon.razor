@using TeslaSolarCharger.Shared.Localization.Contracts
@using TeslaSolarCharger.Shared.Localization.Registries
@using TeslaSolarCharger.Shared.Localization.Registries.Components

@inject ITextLocalizationService TextLocalizer

@if (!string.IsNullOrWhiteSpace(Description))
{
    <MudTooltip Text="@Description"
                Placement="Placement.Top"
                Arrow="true">
        @if (IsCrossedOut)
        {
            <span class="@Class" style="position: relative; display: inline-block;">
                <MudIcon Icon="@IconName" Title="@Description" />
                <span class="cross-line"></span>
            </span>
        }
        else
        {
            <MudIcon Icon="@IconName" Title="@Description" />
        }
    </MudTooltip>
}
else
{
    @if (IsCrossedOut)
    {
        <span class="@Class" style="position: relative; display: inline-block;">
            <MudIcon Icon="@IconName" />
            <span class="cross-line"></span>
        </span>
    }
    else
    {
        <MudIcon Icon="@IconName" />
    }
}

@code {
    [Parameter]
    public string IconName { get; set; } = Icons.Material.Filled.BorderClear;

    [Parameter]
    public string Class { get; set; } = string.Empty;

    [Parameter]
    public bool IsCrossedOut { get; set; }

    [Parameter]
    public string? TooltipText { get; set; }

    [Parameter]
    public string? IsCrossedOutTooltipPrefix { get; set; }

    private string Description =>
        string.IsNullOrWhiteSpace(TooltipText)
            ? string.Empty
            : (IsCrossedOut ? $"{GetTooltipPrefix()}{TooltipText}" : TooltipText);

    private string GetTooltipPrefix() =>
        string.IsNullOrWhiteSpace(IsCrossedOutTooltipPrefix)
            ? T("Not ")
            : IsCrossedOutTooltipPrefix!;

    private string T(string key) =>
        TextLocalizer.Get<CustomIconLocalizationRegistry>(key, typeof(SharedComponentLocalizationRegistry))
        ?? key;
}
